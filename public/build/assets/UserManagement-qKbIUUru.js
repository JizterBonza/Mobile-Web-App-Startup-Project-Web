import{r as i,u as T,j as e,a as C}from"./app-BOLgj3qB.js";import{A as V}from"./AdminLayout-CG6SnJGX.js";function J({auth:o,users:b=[],flash:d}){const[N,k]=i.useState(!1),[S,v]=i.useState(!1),[f,U]=i.useState(!1),[$,x]=i.useState(!1),[g,D]=i.useState(!1),[A,j]=i.useState(!1),[M,E]=i.useState(null),[c,_]=i.useState(null),a=T({first_name:"",middle_name:"",last_name:"",email:"",mobile_number:"",password:"",password_confirmation:"",username:"",user_type:"vendor",status:"active"}),r=T({first_name:"",middle_name:"",last_name:"",email:"",mobile_number:"",password:"",password_confirmation:"",username:"",user_type:"vendor",status:"active"});i.useEffect(()=>{N?setTimeout(()=>v(!0),10):v(!1)},[N]),i.useEffect(()=>{f?setTimeout(()=>x(!0),10):x(!1)},[f]),i.useEffect(()=>{g?setTimeout(()=>j(!0),10):j(!1)},[g]);const p=()=>{v(!1),setTimeout(()=>{k(!1),a.reset()},300)},u=()=>{x(!1),setTimeout(()=>{U(!1),E(null),r.reset()},300)},h=()=>{j(!1),setTimeout(()=>{D(!1),_(null)},300)};i.useEffect(()=>{d!=null&&d.success&&(p(),u(),h(),a.reset(),r.reset(),_(null))},[d]);const q=s=>{s.preventDefault(),a.post(y(),{preserveScroll:!0,onSuccess:()=>{a.reset()}})},R=s=>{E(s),r.setData({first_name:s.first_name,middle_name:s.middle_name||"",last_name:s.last_name,email:s.email,mobile_number:s.mobile_number||"",password:"",password_confirmation:"",username:s.username,user_type:s.user_type,status:s.status}),U(!0),x(!1)},I=s=>{s.preventDefault(),r.put(`${y()}/${M.id}`,{preserveScroll:!0,onSuccess:()=>{u()}})},F=s=>{const n=b.find(l=>l.id===s);_(n),D(!0),j(!1)},B=()=>{c&&C.delete(`${y()}/${c.id}`,{preserveScroll:!0,onSuccess:()=>{h()}})},w=(()=>{var s;return((s=o==null?void 0:o.user)==null?void 0:s.user_type)==="admin"?[{value:"vendor",label:"Vendor"},{value:"veterinarian",label:"Veterinarian"},{value:"rider",label:"Rider"}]:[{value:"super_admin",label:"Super Admin"},{value:"admin",label:"Admin"},{value:"vendor",label:"Vendor"},{value:"veterinarian",label:"Veterinarian"},{value:"customer",label:"Customer"},{value:"rider",label:"Rider"}]})(),y=()=>{var s;return((s=o==null?void 0:o.user)==null?void 0:s.user_type)==="admin"?"/dashboard/admin/users":"/dashboard/super-admin/users"},L=s=>s==="active"?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-danger",children:"Inactive"}),P=s=>{const n=w.find(l=>l.value===s);return n?n.label:s},t=(()=>{const s={};return["super_admin","admin","vendor","veterinarian","customer","rider"].forEach(l=>{s[l]=[]}),b.forEach(l=>{s[l.user_type]?s[l.user_type].push(l):(s.other||(s.other=[]),s.other.push(l))}),s})(),m=(s,n)=>n.length===0?null:e.jsxs("div",{className:"card mb-3",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:[P(s)," (",n.length,")"]})}),e.jsx("div",{className:"card-body table-responsive p-0",children:e.jsxs("table",{className:"table table-hover text-nowrap",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Mobile"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.id}),e.jsx("td",{children:`${l.first_name} ${l.middle_name?l.middle_name+" ":""}${l.last_name}`}),e.jsx("td",{children:l.email}),e.jsx("td",{children:l.mobile_number||"-"}),e.jsx("td",{children:l.username}),e.jsx("td",{children:L(l.status)}),e.jsx("td",{children:new Date(l.created_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm btn-info mr-1",onClick:()=>R(l),title:"Edit User",children:e.jsx("i",{className:"fas fa-edit"})}),l.status==="active"&&e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>F(l.id),title:"Deactivate User",children:e.jsx("i",{className:"fas fa-trash"})})]})]},l.id))})]})})]},s);return e.jsxs(V,{auth:o,title:"User Management",children:[(d==null?void 0:d.success)&&e.jsxs("div",{className:"alert alert-success alert-dismissible fade show",role:"alert",children:[e.jsx("strong",{children:"Success!"})," ",d.success,e.jsx("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:s=>{s.preventDefault(),C.visit(window.location.pathname,{only:["users","auth"],preserveState:!0,preserveScroll:!0})},children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),(d==null?void 0:d.error)&&e.jsxs("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[e.jsx("strong",{children:"Error!"})," ",d.error,e.jsx("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:s=>{s.preventDefault(),C.visit(window.location.pathname,{only:["users","auth"],preserveState:!0,preserveScroll:!0})},children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12",children:[e.jsx("div",{className:"card mb-3",children:e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"User Management"}),e.jsx("div",{className:"card-tools",children:e.jsxs("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>{k(!0),v(!1)},children:[e.jsx("i",{className:"fas fa-plus"})," Add User"]})})]})}),b.length===0?e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("p",{className:"text-center mb-0",children:"No users found"})})}):e.jsxs(e.Fragment,{children:[m("super_admin",t.super_admin),m("admin",t.admin),m("vendor",t.vendor),m("veterinarian",t.veterinarian),m("customer",t.customer),m("rider",t.rider),t.other&&m("other",t.other)]})]})}),N&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${S?"show":""}`,onClick:p}),e.jsx("div",{className:`modal fade ${S?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Add New User"}),e.jsx("button",{type:"button",className:"close",onClick:p,children:e.jsx("span",{children:"×"})})]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["First Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${a.errors.first_name?"is-invalid":""}`,value:a.data.first_name,onChange:s=>a.setData("first_name",s.target.value),required:!0}),a.errors.first_name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.first_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Middle Name"}),e.jsx("input",{type:"text",className:`form-control ${a.errors.middle_name?"is-invalid":""}`,value:a.data.middle_name,onChange:s=>a.setData("middle_name",s.target.value)}),a.errors.middle_name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.middle_name})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Last Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${a.errors.last_name?"is-invalid":""}`,value:a.data.last_name,onChange:s=>a.setData("last_name",s.target.value),required:!0}),a.errors.last_name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.last_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Email ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",className:`form-control ${a.errors.email?"is-invalid":""}`,value:a.data.email,onChange:s=>a.setData("email",s.target.value),required:!0}),a.errors.email&&e.jsx("div",{className:"invalid-feedback",children:a.errors.email})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mobile Number"}),e.jsx("input",{type:"text",className:`form-control ${a.errors.mobile_number?"is-invalid":""}`,value:a.data.mobile_number,onChange:s=>a.setData("mobile_number",s.target.value)}),a.errors.mobile_number&&e.jsx("div",{className:"invalid-feedback",children:a.errors.mobile_number})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",className:`form-control ${a.errors.username?"is-invalid":""}`,value:a.data.username,onChange:s=>a.setData("username",s.target.value),placeholder:"Auto-generated if empty"}),a.errors.username&&e.jsx("div",{className:"invalid-feedback",children:a.errors.username})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Password ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",className:`form-control ${a.errors.password?"is-invalid":""}`,value:a.data.password,onChange:s=>a.setData("password",s.target.value),required:!0}),a.errors.password&&e.jsx("div",{className:"invalid-feedback",children:a.errors.password})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Confirm Password ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",className:`form-control ${a.errors.password_confirmation?"is-invalid":""}`,value:a.data.password_confirmation,onChange:s=>a.setData("password_confirmation",s.target.value),required:!0}),a.errors.password_confirmation&&e.jsx("div",{className:"invalid-feedback",children:a.errors.password_confirmation})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["User Type ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("select",{className:`form-control ${a.errors.user_type?"is-invalid":""}`,value:a.data.user_type,onChange:s=>a.setData("user_type",s.target.value),required:!0,children:w.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),a.errors.user_type&&e.jsx("div",{className:"invalid-feedback",children:a.errors.user_type})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Status ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("select",{className:`form-control ${a.errors.status?"is-invalid":""}`,value:a.data.status,onChange:s=>a.setData("status",s.target.value),required:!0,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),a.errors.status&&e.jsx("div",{className:"invalid-feedback",children:a.errors.status})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a.processing,children:a.processing?"Creating...":"Create User"})]})]})]})})})]}),f&&M&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${$?"show":""}`,onClick:u}),e.jsx("div",{className:`modal fade ${$?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Edit User"}),e.jsx("button",{type:"button",className:"close",onClick:u,children:e.jsx("span",{children:"×"})})]}),e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["First Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${r.errors.first_name?"is-invalid":""}`,value:r.data.first_name,onChange:s=>r.setData("first_name",s.target.value),required:!0}),r.errors.first_name&&e.jsx("div",{className:"invalid-feedback",children:r.errors.first_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Middle Name"}),e.jsx("input",{type:"text",className:`form-control ${r.errors.middle_name?"is-invalid":""}`,value:r.data.middle_name,onChange:s=>r.setData("middle_name",s.target.value)}),r.errors.middle_name&&e.jsx("div",{className:"invalid-feedback",children:r.errors.middle_name})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Last Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${r.errors.last_name?"is-invalid":""}`,value:r.data.last_name,onChange:s=>r.setData("last_name",s.target.value),required:!0}),r.errors.last_name&&e.jsx("div",{className:"invalid-feedback",children:r.errors.last_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Email ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",className:`form-control ${r.errors.email?"is-invalid":""}`,value:r.data.email,onChange:s=>r.setData("email",s.target.value),required:!0}),r.errors.email&&e.jsx("div",{className:"invalid-feedback",children:r.errors.email})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mobile Number"}),e.jsx("input",{type:"text",className:`form-control ${r.errors.mobile_number?"is-invalid":""}`,value:r.data.mobile_number,onChange:s=>r.setData("mobile_number",s.target.value)}),r.errors.mobile_number&&e.jsx("div",{className:"invalid-feedback",children:r.errors.mobile_number})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",className:`form-control ${r.errors.username?"is-invalid":""}`,value:r.data.username,onChange:s=>r.setData("username",s.target.value)}),r.errors.username&&e.jsx("div",{className:"invalid-feedback",children:r.errors.username})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password (leave blank to keep current)"}),e.jsx("input",{type:"password",className:`form-control ${r.errors.password?"is-invalid":""}`,value:r.data.password,onChange:s=>r.setData("password",s.target.value),placeholder:"Leave blank to keep current password"}),r.errors.password&&e.jsx("div",{className:"invalid-feedback",children:r.errors.password})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm Password"}),e.jsx("input",{type:"password",className:`form-control ${r.errors.password_confirmation?"is-invalid":""}`,value:r.data.password_confirmation,onChange:s=>r.setData("password_confirmation",s.target.value),placeholder:"Required if changing password"}),r.errors.password_confirmation&&e.jsx("div",{className:"invalid-feedback",children:r.errors.password_confirmation})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["User Type ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("select",{className:`form-control ${r.errors.user_type?"is-invalid":""}`,value:r.data.user_type,onChange:s=>r.setData("user_type",s.target.value),required:!0,children:w.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),r.errors.user_type&&e.jsx("div",{className:"invalid-feedback",children:r.errors.user_type})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Status ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("select",{className:`form-control ${r.errors.status?"is-invalid":""}`,value:r.data.status,onChange:s=>r.setData("status",s.target.value),required:!0,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),r.errors.status&&e.jsx("div",{className:"invalid-feedback",children:r.errors.status})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r.processing,children:r.processing?"Updating...":"Update User"})]})]})]})})})]}),g&&c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${A?"show":""}`,onClick:h}),e.jsx("div",{className:`modal fade ${A?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Confirm Deactivation"}),e.jsx("button",{type:"button",className:"close",onClick:h,children:e.jsx("span",{children:"×"})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Are you sure you want to deactivate"," ",e.jsxs("strong",{children:[c.first_name," ",c.middle_name?c.middle_name+" ":"",c.last_name]}),"?"]}),e.jsx("p",{className:"text-muted mb-0",children:'This will set their status to "Inactive". The user will not be able to access the system.'})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:h,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:B,children:"Deactivate User"})]})]})})})]})]})}export{J as default};
