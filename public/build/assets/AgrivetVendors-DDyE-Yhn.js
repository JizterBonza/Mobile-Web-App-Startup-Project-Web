import{r,u as S,j as e,a as A,L as O}from"./app-BOLgj3qB.js";import{A as Q}from"./AdminLayout-CG6SnJGX.js";function Y({auth:u,agrivet:o,shop:c,vendors:_=[],availableVendors:U=[],flash:d}){const[w,E]=r.useState(!1),[M,j]=r.useState(!1),[y,D]=r.useState(!1),[V,v]=r.useState(!1),[k,R]=r.useState(!1),[T,b]=r.useState(!1),[C,I]=r.useState(!1),[q,p]=r.useState(!1),[F,L]=r.useState(null),[n,$]=r.useState(null),a=S({first_name:"",middle_name:"",last_name:"",email:"",mobile_number:"",password:"",password_confirmation:"",username:"",status:"active"}),l=S({first_name:"",middle_name:"",last_name:"",email:"",mobile_number:"",password:"",password_confirmation:"",username:"",status:"active"}),i=S({vendor_id:""});r.useEffect(()=>{w?setTimeout(()=>j(!0),10):j(!1)},[w]),r.useEffect(()=>{y?setTimeout(()=>v(!0),10):v(!1)},[y]),r.useEffect(()=>{k?setTimeout(()=>b(!0),10):b(!1)},[k]),r.useEffect(()=>{C?setTimeout(()=>p(!0),10):p(!1)},[C]);const N=()=>{j(!1),setTimeout(()=>{E(!1),a.reset()},300)},m=()=>{v(!1),setTimeout(()=>{D(!1),L(null),l.reset()},300)},h=()=>{b(!1),setTimeout(()=>{R(!1),$(null)},300)},f=()=>{p(!1),setTimeout(()=>{I(!1),i.reset()},300)};r.useEffect(()=>{d!=null&&d.success&&(N(),m(),h(),f(),a.reset(),l.reset(),i.reset(),$(null))},[d]);const x=()=>{var s;return((s=u==null?void 0:u.user)==null?void 0:s.user_type)==="admin"?"/dashboard/admin/agrivets":"/dashboard/super-admin/agrivets"},z=s=>{s.preventDefault(),a.post(`${x()}/${o.id}/shops/${c.id}/vendors`,{preserveScroll:!0,onSuccess:()=>{a.reset()}})},P=s=>{var t;L(s),l.setData({first_name:s.first_name,middle_name:s.middle_name||"",last_name:s.last_name,email:s.email,mobile_number:s.mobile_number||"",password:"",password_confirmation:"",username:s.username,status:((t=s.pivot)==null?void 0:t.status)||s.status||"active"}),D(!0),v(!1)},B=s=>{s.preventDefault(),l.put(`${x()}/${o.id}/shops/${c.id}/vendors/${F.id}`,{preserveScroll:!0,onSuccess:()=>{m()}})},G=s=>{const t=_.find(g=>g.id===s);$(t),R(!0),b(!1)},H=()=>{n&&A.delete(`${x()}/${o.id}/shops/${c.id}/vendors/${n.id}`,{preserveScroll:!0,onSuccess:()=>{h()}})},J=s=>{s.preventDefault(),i.post(`${x()}/${o.id}/shops/${c.id}/vendors/add-existing`,{preserveScroll:!0,onSuccess:()=>{i.reset()}})},K=s=>s==="active"?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-danger",children:"Inactive"});return e.jsxs(Q,{auth:u,title:`Vendors - ${c.shop_name} (${o.name})`,children:[(d==null?void 0:d.success)&&e.jsxs("div",{className:"alert alert-success alert-dismissible fade show",role:"alert",children:[e.jsx("strong",{children:"Success!"})," ",d.success,e.jsx("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>A.reload({only:["flash"]}),children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),(d==null?void 0:d.error)&&e.jsxs("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[e.jsx("strong",{children:"Error!"})," ",d.error,e.jsx("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:()=>A.reload({only:["flash"]}),children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsxs(O,{href:`${x()}/${o.id}/shops`,className:"btn btn-secondary btn-sm",children:[e.jsx("i",{className:"fas fa-arrow-left"})," Back to Shops"]})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{className:"card-title",children:["Vendors for ",c.shop_name]}),e.jsxs("div",{className:"card-tools",children:[e.jsxs("button",{type:"button",className:"btn btn-success btn-sm mr-2",onClick:()=>{I(!0),p(!1)},children:[e.jsx("i",{className:"fas fa-plus-circle"})," Add Existing Vendor"]}),e.jsxs("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>{E(!0),j(!1)},children:[e.jsx("i",{className:"fas fa-plus"})," Create New Vendor"]})]})]}),e.jsx("div",{className:"card-body table-responsive p-0",children:e.jsxs("table",{className:"table table-hover text-nowrap",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Mobile"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:_.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center",children:"No vendors found"})}):_.map(s=>{var t,g;return e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:`${s.first_name} ${s.middle_name?s.middle_name+" ":""}${s.last_name}`}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.mobile_number||"-"}),e.jsx("td",{children:s.username}),e.jsx("td",{children:K(((t=s.pivot)==null?void 0:t.status)||s.status)}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm btn-info mr-1",onClick:()=>P(s),title:"Edit Vendor",children:e.jsx("i",{className:"fas fa-edit"})}),(((g=s.pivot)==null?void 0:g.status)==="active"||s.status==="active")&&e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>G(s.id),title:"Remove Vendor",children:e.jsx("i",{className:"fas fa-trash"})})]})]},s.id)})})]})})]})})}),w&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${M?"show":""}`,onClick:N}),e.jsx("div",{className:`modal fade ${M?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Create New Vendor"}),e.jsx("button",{type:"button",className:"close",onClick:N,children:e.jsx("span",{children:"×"})})]}),e.jsxs("form",{onSubmit:z,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["First Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${a.errors.first_name?"is-invalid":""}`,value:a.data.first_name,onChange:s=>a.setData("first_name",s.target.value),required:!0}),a.errors.first_name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.first_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Middle Name"}),e.jsx("input",{type:"text",className:`form-control ${a.errors.middle_name?"is-invalid":""}`,value:a.data.middle_name,onChange:s=>a.setData("middle_name",s.target.value)}),a.errors.middle_name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.middle_name})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Last Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${a.errors.last_name?"is-invalid":""}`,value:a.data.last_name,onChange:s=>a.setData("last_name",s.target.value),required:!0}),a.errors.last_name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.last_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Email ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",className:`form-control ${a.errors.email?"is-invalid":""}`,value:a.data.email,onChange:s=>a.setData("email",s.target.value),required:!0}),a.errors.email&&e.jsx("div",{className:"invalid-feedback",children:a.errors.email})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mobile Number"}),e.jsx("input",{type:"text",className:`form-control ${a.errors.mobile_number?"is-invalid":""}`,value:a.data.mobile_number,onChange:s=>a.setData("mobile_number",s.target.value)}),a.errors.mobile_number&&e.jsx("div",{className:"invalid-feedback",children:a.errors.mobile_number})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",className:`form-control ${a.errors.username?"is-invalid":""}`,value:a.data.username,onChange:s=>a.setData("username",s.target.value),placeholder:"Auto-generated if empty"}),a.errors.username&&e.jsx("div",{className:"invalid-feedback",children:a.errors.username})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Password ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",className:`form-control ${a.errors.password?"is-invalid":""}`,value:a.data.password,onChange:s=>a.setData("password",s.target.value),required:!0}),a.errors.password&&e.jsx("div",{className:"invalid-feedback",children:a.errors.password})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Confirm Password ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",className:`form-control ${a.errors.password_confirmation?"is-invalid":""}`,value:a.data.password_confirmation,onChange:s=>a.setData("password_confirmation",s.target.value),required:!0}),a.errors.password_confirmation&&e.jsx("div",{className:"invalid-feedback",children:a.errors.password_confirmation})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:N,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a.processing,children:a.processing?"Creating...":"Create Vendor"})]})]})]})})})]}),y&&F&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${V?"show":""}`,onClick:m}),e.jsx("div",{className:`modal fade ${V?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Edit Vendor"}),e.jsx("button",{type:"button",className:"close",onClick:m,children:e.jsx("span",{children:"×"})})]}),e.jsxs("form",{onSubmit:B,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["First Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${l.errors.first_name?"is-invalid":""}`,value:l.data.first_name,onChange:s=>l.setData("first_name",s.target.value),required:!0}),l.errors.first_name&&e.jsx("div",{className:"invalid-feedback",children:l.errors.first_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Middle Name"}),e.jsx("input",{type:"text",className:`form-control ${l.errors.middle_name?"is-invalid":""}`,value:l.data.middle_name,onChange:s=>l.setData("middle_name",s.target.value)}),l.errors.middle_name&&e.jsx("div",{className:"invalid-feedback",children:l.errors.middle_name})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Last Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${l.errors.last_name?"is-invalid":""}`,value:l.data.last_name,onChange:s=>l.setData("last_name",s.target.value),required:!0}),l.errors.last_name&&e.jsx("div",{className:"invalid-feedback",children:l.errors.last_name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Email ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",className:`form-control ${l.errors.email?"is-invalid":""}`,value:l.data.email,onChange:s=>l.setData("email",s.target.value),required:!0}),l.errors.email&&e.jsx("div",{className:"invalid-feedback",children:l.errors.email})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mobile Number"}),e.jsx("input",{type:"text",className:`form-control ${l.errors.mobile_number?"is-invalid":""}`,value:l.data.mobile_number,onChange:s=>l.setData("mobile_number",s.target.value)}),l.errors.mobile_number&&e.jsx("div",{className:"invalid-feedback",children:l.errors.mobile_number})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Username"}),e.jsx("input",{type:"text",className:`form-control ${l.errors.username?"is-invalid":""}`,value:l.data.username,onChange:s=>l.setData("username",s.target.value)}),l.errors.username&&e.jsx("div",{className:"invalid-feedback",children:l.errors.username})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password (leave blank to keep current)"}),e.jsx("input",{type:"password",className:`form-control ${l.errors.password?"is-invalid":""}`,value:l.data.password,onChange:s=>l.setData("password",s.target.value),placeholder:"Leave blank to keep current password"}),l.errors.password&&e.jsx("div",{className:"invalid-feedback",children:l.errors.password})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm Password"}),e.jsx("input",{type:"password",className:`form-control ${l.errors.password_confirmation?"is-invalid":""}`,value:l.data.password_confirmation,onChange:s=>l.setData("password_confirmation",s.target.value),placeholder:"Required if changing password"}),l.errors.password_confirmation&&e.jsx("div",{className:"invalid-feedback",children:l.errors.password_confirmation})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:m,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:l.processing,children:l.processing?"Updating...":"Update Vendor"})]})]})]})})})]}),k&&n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${T?"show":""}`,onClick:h}),e.jsx("div",{className:`modal fade ${T?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Confirm Removal"}),e.jsx("button",{type:"button",className:"close",onClick:h,children:e.jsx("span",{children:"×"})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Are you sure you want to remove"," ",e.jsxs("strong",{children:[n.first_name," ",n.middle_name?n.middle_name+" ":"",n.last_name]})," from this Shop?"]}),e.jsx("p",{className:"text-muted mb-0",children:`This will set the vendor's status to "Inactive" for this Shop. The vendor will still exist in the system.`})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:h,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:H,children:"Remove Vendor"})]})]})})})]}),C&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${q?"show":""}`,onClick:f}),e.jsx("div",{className:`modal fade ${q?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Add Existing Vendor"}),e.jsx("button",{type:"button",className:"close",onClick:f,children:e.jsx("span",{children:"×"})})]}),e.jsxs("form",{onSubmit:J,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Select Vendor ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("select",{className:`form-control ${i.errors.vendor_id?"is-invalid":""}`,value:i.data.vendor_id,onChange:s=>i.setData("vendor_id",s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Select a vendor --"}),U.map(s=>e.jsx("option",{value:s.id,children:`${s.first_name} ${s.middle_name?s.middle_name+" ":""}${s.last_name} (${s.email})`},s.id))]}),i.errors.vendor_id&&e.jsx("div",{className:"invalid-feedback",children:i.errors.vendor_id})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:f,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i.processing,children:i.processing?"Adding...":"Add Vendor"})]})]})]})})})]})]})}export{Y as default};
