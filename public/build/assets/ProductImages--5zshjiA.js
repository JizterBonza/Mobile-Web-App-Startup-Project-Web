import{r as l,u as R,j as e,a as w}from"./app-BOLgj3qB.js";import{A as X}from"./AdminLayout-CG6SnJGX.js";function te({auth:$,productImages:I=[],shop:Z,agrivet:ee,flash:i}){const[b,N]=l.useState(!1),[A,m]=l.useState(!1),[f,D]=l.useState(!1),[F,g]=l.useState(!1),[y,E]=l.useState(!1),[L,v]=l.useState(!1),[S,U]=l.useState(null),[o,M]=l.useState(null),[n,C]=l.useState(null),[c,k]=l.useState(null),[u,T]=l.useState(""),[h,G]=l.useState(""),[d,O]=l.useState(""),a=R({name:"",image:null,category:"",status:"active"}),t=R({name:"",image:null,category:"",status:"active"}),W=[...new Set(I.map(s=>s.category).filter(Boolean))],P=I.filter(s=>{const r=!u||s.category===u,K=!h||s.status===h,Q=!d||s.name.toLowerCase().includes(d.toLowerCase())||s.category&&s.category.toLowerCase().includes(d.toLowerCase());return r&&K&&Q});l.useEffect(()=>{b?setTimeout(()=>m(!0),10):m(!1)},[b]),l.useEffect(()=>{f?setTimeout(()=>g(!0),10):g(!1)},[f]),l.useEffect(()=>{y?setTimeout(()=>v(!0),10):v(!1)},[y]);const p=()=>{m(!1),setTimeout(()=>{N(!1),a.reset(),n&&(URL.revokeObjectURL(n),C(null))},300)},x=()=>{g(!1),setTimeout(()=>{D(!1),U(null),t.reset(),c&&c.startsWith("blob:")&&URL.revokeObjectURL(c),k(null)},300)},j=()=>{v(!1),setTimeout(()=>{E(!1),M(null)},300)},B=s=>{const r=s.target.files[0];r&&(a.setData("image",r),n&&URL.revokeObjectURL(n),C(URL.createObjectURL(r)))},J=s=>{const r=s.target.files[0];r&&(t.setData("image",r),c&&c.startsWith("blob:")&&URL.revokeObjectURL(c),k(URL.createObjectURL(r))),s.target.value=""};l.useEffect(()=>{i!=null&&i.success&&(p(),x(),j(),a.reset(),t.reset())},[i]);const V=s=>{s.preventDefault(),a.post("/dashboard/vendor/product-images",{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{a.reset(),n&&(URL.revokeObjectURL(n),C(null))}})},_=s=>{U(s),t.setData({name:s.name||"",image:null,category:s.category||"",status:s.status||"active"}),k(s.image_url),D(!0),g(!1)},q=s=>{s.preventDefault(),S&&t.transform(r=>({...r,_method:"PUT"})).post(`/dashboard/vendor/product-images/${S.id}`,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{c&&c.startsWith("blob:")&&URL.revokeObjectURL(c),x()}})},z=s=>{M(s),E(!0),v(!1)},H=()=>{o&&w.delete(`/dashboard/vendor/product-images/${o.id}`,{preserveScroll:!0,onSuccess:()=>{j()}})},Y=s=>s==="active"?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-danger",children:"Inactive"});return e.jsxs(X,{auth:$,title:"Product Images",children:[(i==null?void 0:i.success)&&e.jsxs("div",{className:"alert alert-success alert-dismissible fade show",role:"alert",children:[e.jsx("strong",{children:"Success!"})," ",i.success,e.jsx("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:s=>{s.preventDefault(),w.visit(window.location.pathname,{preserveState:!0,preserveScroll:!0})},children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),(i==null?void 0:i.error)&&e.jsxs("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[e.jsx("strong",{children:"Error!"})," ",i.error,e.jsx("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:s=>{s.preventDefault(),w.visit(window.location.pathname,{preserveState:!0,preserveScroll:!0})},children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"callout callout-info",children:[e.jsxs("h5",{children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Product Image Stock"]}),e.jsx("p",{className:"mb-0",children:"Manage your product image library here. Upload images once and reuse them across multiple products to ensure consistency and uniformity in your product listings."})]})})}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"form-group",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by name or category...",value:d,onChange:s=>O(s.target.value)})})}),e.jsx("div",{className:"col-md-3",children:e.jsx("div",{className:"form-group",children:e.jsxs("select",{className:"form-control",value:u,onChange:s=>T(s.target.value),children:[e.jsx("option",{value:"",children:"All Categories"}),W.map((s,r)=>e.jsx("option",{value:s,children:s},r))]})})}),e.jsx("div",{className:"col-md-2",children:e.jsx("div",{className:"form-group",children:e.jsxs("select",{className:"form-control",value:h,onChange:s=>G(s.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})})}),e.jsx("div",{className:"col-md-3 text-right",children:e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>{N(!0),m(!1)},children:[e.jsx("i",{className:"fas fa-plus mr-1"})," Add Image"]})})]}),e.jsx("div",{className:"row",children:P.length===0?e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-5",children:[e.jsx("i",{className:"fas fa-images fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No product images found"}),e.jsx("p",{className:"text-muted mb-3",children:d||u||h?"Try adjusting your filters or search term.":"Start by adding your first product image to the library."}),!d&&!u&&!h&&e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>{N(!0),m(!1)},children:[e.jsx("i",{className:"fas fa-plus mr-1"})," Add Your First Image"]})]})})}):P.map(s=>e.jsx("div",{className:"col-lg-3 col-md-4 col-sm-6 mb-4",children:e.jsxs("div",{className:"card h-100",children:[e.jsxs("div",{className:"position-relative",children:[e.jsx("img",{src:s.image_url,alt:s.name,className:"card-img-top",style:{height:"180px",objectFit:"cover"},onError:r=>{r.target.src="/images/placeholder.png"}}),e.jsx("div",{className:"position-absolute",style:{top:"10px",right:"10px"},children:Y(s.status)})]}),e.jsxs("div",{className:"card-body p-3",children:[e.jsx("h6",{className:"card-title mb-1 text-truncate",title:s.name,children:s.name}),s.category&&e.jsxs("small",{className:"text-muted d-block mb-2",children:[e.jsx("i",{className:"fas fa-folder mr-1"})," ",s.category]})]}),e.jsxs("div",{className:"card-footer bg-transparent p-2",children:[e.jsx("button",{className:"btn btn-sm btn-info mr-1",onClick:()=>_(s),title:"Edit",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>z(s),title:"Delete",children:e.jsx("i",{className:"fas fa-trash"})})]})]})},s.id))}),b&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${A?"show":""}`,onClick:p}),e.jsx("div",{className:`modal fade ${A?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Add Product Image"}),e.jsx("button",{type:"button",className:"close",onClick:p,children:e.jsx("span",{children:"×"})})]}),e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Image Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${a.errors.name?"is-invalid":""}`,value:a.data.name,onChange:s=>a.setData("name",s.target.value),placeholder:"e.g., Chicken Feed - Premium",required:!0}),a.errors.name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.name})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Image ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"file",className:`form-control ${a.errors.image?"is-invalid":""}`,onChange:B,accept:"image/*",required:!0}),a.errors.image&&e.jsx("div",{className:"invalid-feedback",children:a.errors.image}),e.jsx("small",{className:"form-text text-muted",children:"JPEG, PNG, JPG, or GIF - Max 5MB"}),n&&e.jsx("div",{className:"mt-3 text-center",children:e.jsx("img",{src:n,alt:"Preview",className:"img-thumbnail",style:{maxHeight:"200px",maxWidth:"100%",objectFit:"contain"}})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{className:`form-control ${a.errors.category?"is-invalid":""}`,value:a.data.category,onChange:s=>a.setData("category",s.target.value),children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Animal Feed",children:"Animal Feed"}),e.jsx("option",{value:"Feed Supplements",children:"Feed Supplements"}),e.jsx("option",{value:"Animal Vitamins & Nutritional Supplements",children:"Animal Vitamins & Nutritional Supplements"})]}),a.errors.category&&e.jsx("div",{className:"invalid-feedback",children:a.errors.category})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:`form-control ${a.errors.status?"is-invalid":""}`,value:a.data.status,onChange:s=>a.setData("status",s.target.value),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),a.errors.status&&e.jsx("div",{className:"invalid-feedback",children:a.errors.status})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a.processing,children:a.processing?"Uploading...":"Add Image"})]})]})]})})})]}),f&&S&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${F?"show":""}`,onClick:x}),e.jsx("div",{className:`modal fade ${F?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Edit Product Image"}),e.jsx("button",{type:"button",className:"close",onClick:x,children:e.jsx("span",{children:"×"})})]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Image Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${t.errors.name?"is-invalid":""}`,value:t.data.name,onChange:s=>t.setData("name",s.target.value),required:!0}),t.errors.name&&e.jsx("div",{className:"invalid-feedback",children:t.errors.name})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Current Image"}),c&&e.jsx("div",{className:"mb-2 text-center",children:e.jsx("img",{src:c,alt:"Current",className:"img-thumbnail",style:{maxHeight:"200px",maxWidth:"100%",objectFit:"contain"},onError:s=>{s.target.src="/images/placeholder.png"}})}),e.jsx("input",{type:"file",className:`form-control ${t.errors.image?"is-invalid":""}`,onChange:J,accept:"image/*"}),t.errors.image&&e.jsx("div",{className:"invalid-feedback",children:t.errors.image}),e.jsx("small",{className:"form-text text-muted",children:"Leave empty to keep current image. JPEG, PNG, JPG, or GIF - Max 5MB"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{className:`form-control ${t.errors.category?"is-invalid":""}`,value:t.data.category,onChange:s=>t.setData("category",s.target.value),children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Animal Feed",children:"Animal Feed"}),e.jsx("option",{value:"Feed Supplements",children:"Feed Supplements"}),e.jsx("option",{value:"Animal Vitamins & Nutritional Supplements",children:"Animal Vitamins & Nutritional Supplements"})]}),t.errors.category&&e.jsx("div",{className:"invalid-feedback",children:t.errors.category})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:`form-control ${t.errors.status?"is-invalid":""}`,value:t.data.status,onChange:s=>t.setData("status",s.target.value),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),t.errors.status&&e.jsx("div",{className:"invalid-feedback",children:t.errors.status})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:x,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t.processing,children:t.processing?"Updating...":"Update Image"})]})]})]})})})]}),y&&o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`modal-backdrop fade ${L?"show":""}`,onClick:j}),e.jsx("div",{className:`modal fade ${L?"show":""} d-block`,tabIndex:"-1",style:{zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h4",{className:"modal-title",children:"Confirm Delete"}),e.jsx("button",{type:"button",className:"close",onClick:j,children:e.jsx("span",{children:"×"})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"text-center mb-3",children:e.jsx("img",{src:o.image_url,alt:o.name,className:"img-thumbnail",style:{maxHeight:"150px",maxWidth:"100%",objectFit:"contain"},onError:s=>{s.target.src="/images/placeholder.png"}})}),e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("strong",{children:o.name}),"?"]}),e.jsx("p",{className:"text-muted mb-0",children:"This action cannot be undone. Products using this image will not be affected."})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:j,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:H,children:"Delete Image"})]})]})})})]})]})}export{te as default};
